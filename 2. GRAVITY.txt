================================================================================
COMMIT-CENTRIC MODEL (CCM): GRAVITY LAYER
Гравитация как неоднородность темпа Commit
================================================================================
Версия: v1.3 (Gravity layer, RU)
Дата: Декабрь 2025
Формат: русский текст; термины — English (Bulk, Commit, Fact, FactLog, Instrument,
CPTP, DI, DI-knife, lapse, d_medium, tick-fact).
================================================================================


АННОТАЦИЯ
---------
Этот слой подключается к CCM Core v4.8.x через интерфейс:

  λ_local(x) = T(x) * ω_record,

где T(x) ∈ (0,1] — lapse: локальный множитель темпа Commit (скорости фиксации Facts),
а ω_record — характерная частота record-подсистемы (Instrument часов).

Слой задаёт:
- d_medium как причинную метрику среды (стоимость передачи/задержка),
- weak-field correspondence: T(x) = sqrt(1 + 2Φ(x)/c^2),
- redshift как отношение скоростей часов (tick-facts),
- Shapiro-type delay как глобальный функционал от T(x) вдоль пути,
- DI-knife запрет сегментационно-зависимых “micro-facts” в гравитационных моделях.

Слой якорится SI-тестами:
- G03_SV_redshift_SI_from_ticks_v2.py (clock-based redshift, GPS grav-only),
- G05_SV_shapiro_delay_segmentation_DI_v3.py (delay + DI-knife negative control).


ОГЛАВЛЕНИЕ
----------
0. Конвенции и границы слоя
1. Интерфейс к ядру: λ_local(x) = T(x) * ω_record
2. d_medium: причинная метрика среды
3. Часы и redshift как отношение tick-rates
4. Shapiro-type delay как функционал от T(x)
5. DI-knife в gravity: что запрещено
6. Anchor summary (читабельно) + ссылки на тесты
7. Открытые вопросы слоя
8. Приложение: артефакты и воспроизводимость


================================================================================
0. КОНВЕНЦИИ И ГРАНИЦЫ СЛОЯ
================================================================================

0.1. Три “времени”
------------------
Слой использует различение CCM Core:

- τ (bulk-parameter): внутренняя параметризация Bulk-унитарности. Не Fact.
- n (FactLog index): порядок Facts в FactLog. Это Fact-структура.
- “физическое время” = показания часов: статистика tick-facts в FactLog.

0.2. Что слой НЕ делает
-----------------------
- Слой не выводит динамику поля T(x).
- Слой не претендует на “новую гравитацию”: он задаёт correspondence с GR в слабом поле.
- Слой не смешивает “шум по сегментам” с физикой: DI-knife запрещает сегментационные ручки.

0.3. Нотация
------------
- x: метка “места/события” в effective description.
- Φ(x): ньютоновский потенциал (weak-field parameterization).
- c: скорость света (SI).
- G: гравитационная константа (SI).
- T(x): lapse ∈ (0,1].
- d_medium: причинная метрика среды.


================================================================================
1. ИНТЕРФЕЙС К ЯДРУ: λ_local(x) = T(x) * ω_record
================================================================================

1.1. Базовая связь
------------------
CCM Core фиксирует (P3, секция 4.5):
- λ_I — hazard Instrument I, определяется ω_record(I).
- Survival экспоненциален (теорема T3 из DI-segmentation).

Gravity layer вводит поле:

    T(x) ∈ (0,1]   (lapse)

и определяет пространственную модуляцию hazard:

    λ_local(x) = T(x) · λ_I.

Это ИНТЕРФЕЙС к Core, не новый постулат.

Интерпретация:
- T(x) = 1: эталонная скорость фиксации Facts.
- T(x) < 1: Commit реже (FactLog растёт медленнее локально).


1.2. Correspondence с GR (weak field)
-------------------------------------
ИНТЕРФЕЙС (не постулат CCM):

    T(x) = sqrt(1 + 2Φ(x)/c²),    при |Φ|/c² << 1.

Это требование СОГЛАСОВАННОСТИ с GR, не вывод из CCM.

Обоснование:
GR задаёт proper time через метрику:
    
    dτ_proper = sqrt(g₀₀) dt_coord.

В weak field: g₀₀ = 1 + 2Φ/c².

CCM интерпретирует: локальный темп Commit = T(x) = sqrt(g₀₀).

Любой другой T(x) даёт расхождение с GR-предсказаниями (redshift, Shapiro).
Эксперимент фиксирует форму T(x), не теория.

Anchor: G03_SV_redshift_SI_from_ticks_v2.py


================================================================================
2. d_medium: ПРИЧИННАЯ МЕТРИКА СРЕДЫ
================================================================================

2.1. Смысл d_medium
-------------------
d_medium описывает причинную стоимость/задержку передачи Facts (“сигнал принят”) в среде.
Это не корреляционная близость (она живёт в d_matter ядра).

2.2. Прототип определения
-------------------------
В effective description вводится функционал по пути γ:

  d_medium(A,B) = inf_{γ:A->B} ∫_γ ds / T(x).

Смысл:
- “далеко” в d_medium означает “дорого/долго по передаче”.
- причинность и сигнальные ограничения относятся к d_medium.


================================================================================
3. ЧАСЫ И REDSHIFT КАК ОТНОШЕНИЕ TICK-RATES
================================================================================

3.1. Определение redshift в CCM-терминах
---------------------------------------
В CCM физическое время задаётся показаниями часов: tick-facts в FactLog.
Redshift определяется через отношение скоростей хода часов.

Слой использует интерфейс:

  ω_record(x) = T(x) * ω_record(∞).

То есть локальные частоты record-переходов redshift-ятся пропорционально T(x).

3.2. Формула redshift
---------------------
Пусть сигнал эмитирован при T_emit и наблюдается при T_obs.
Тогда отношение частот (через tick-rate часов) задаётся:

  ν_obs / ν_emit = T_emit / T_obs,

эквивалентно:

  1 + z = T_obs / T_emit.

Для наблюдателя “на бесконечности” (T_obs = 1):

  z = 1/T_emit - 1.


================================================================================
4. SHAPIRO-TYPE DELAY КАК ФУНКЦИОНАЛ ОТ T(x)
================================================================================

4.1. Принцип: delay должен быть глобальным, не micro-sum
--------------------------------------------------------
DI-knife запрещает “гравитационную задержку” как сумму независимых локальных
случайных микровкладов по сегментам пути.

Разрешённый шаблон: delay как глобальный функционал от поля T(x) вдоль пути,
инвариантный к пересегментации.

4.2. Прототип задержки (layer choice)
-------------------------------------
В прототипе слоя используется:

  Δt = ∫_path ( 1/T(x)^2 - 1 ) dx / c,

где интеграл берётся вдоль effective пути передачи.

Фактор T^2 относится к choice протокола передачи (layer choice) и якорится численно.

4.3. DI-segmentation check для интеграла
----------------------------------------
При фиксированном T(x) и фиксированном пути, разбиение интервала интегрирования
на N или 2N сегментов является описательным. Следовательно, Δt должен быть
численно стабильным при уточнении N:

  Δt(N) -> Δt(2N) при N -> large.


================================================================================
5. DI-KNIFE В GRAVITY: ЧТО ЗАПРЕЩЕНО
================================================================================

5.1. Запрещено: micro-noise sum вдоль сегментов
-----------------------------------------------
Запрещённая конструкция: объявить delay фактом вида

  Δt = (глобальный интеграл) + Σ_{i=1..N} ξ_i,

где ξ_i независимы и N — число сегментов описания. Тогда:

  std(Δt) ~ 1/sqrt(N),

то есть статистика “факта задержки” зависит от сегментации. Это нарушение DI:
“ручка N” становится физикой.

5.2. Разрешено: глобальный шум, независимый от сегментации
----------------------------------------------------------
Если вводится шум, он должен быть глобальным (одна случайная величина на факт),
а не суммой независимых вкладов, число которых является описательным параметром.


================================================================================
6. ANCHOR SUMMARY
================================================================================

6.1. Anchor G03: redshift через tick-rates (SI, clock-based)
------------------------------------------------------------
Файл:
  G03_SV_redshift_SI_from_ticks_v2.py

SOLAR (surface -> infinity):
  z_ticks = 2.121102575581e-06
  совпадает с GR exact (abs error = 0)

GPS (grav-only):
  Δt/day = +45.724435 μs
  совпадает с GR exact (abs error = 0)

Смысл якоря:
- redshift вычисляется через определение CCM-времени (ticks), а не подстановкой в формулу z(T);
- выбранная lapse-калибровка корректно воспроизводит weak-field correspondence.

6.2. Anchor G05: Shapiro-type delay + DI-knife (segmentation)
-------------------------------------------------------------
Файл:
  G05_SV_shapiro_delay_segmentation_DI_v3.py

Shapiro-type (L=1 AU, b=1.1 R_sun):
  Δt_CCM = 117.605921 μs
  refinement stability: Δrel = 1.250821e-09
  correspondence vs GR approx: relative error = 8.605040e-08

DI-knife:
  forbidden micro-noise: slope log(std) vs log(N) = -0.5004 (segmentation dependence detected)
  DI-safe global noise:  slope log(std) vs log(N) = -0.0011 (segmentation-invariant)

Смысл якоря:
- delay реализован как глобальный функционал от T(x), устойчивый к refinement (DI-consistent),
- запрещённый сегментационный шум проявляется в характерном std~1/sqrt(N).

(Полные логи относятся к reproducibility artefacts, не к основному тексту.)


================================================================================
7. ОТКРЫТЫЕ ВОПРОСЫ СЛОЯ
================================================================================

- Динамика T(x): уравнения движения, источники, ковариантная формулировка.
- Почему именно степень 2 в (1/T^2 - 1) для delay: это протокол слоя, может быть
  заменён при переходе к более фундаментальному описанию передачи.
- Полная релятивистская постановка (включая SR кинематический вклад для GPS) —
  отдельный слой/расширение протокола.


================================================================================
8. ПРИЛОЖЕНИЕ: АРТЕФАКТЫ И ВОСПРОИЗВОДИМОСТЬ
================================================================================

Рекомендуемый формат:
- artifacts/G03_run.txt  (stdout прогона)
- artifacts/G05_run.txt  (stdout прогона)

Файлы тестов:
- G03_SV_redshift_SI_from_ticks_v2.py
- G05_SV_shapiro_delay_segmentation_DI_v3.py

Примечание:
SystemExit:0 в Jupyter — не ошибка теста. Для ноутбука можно заменить
raise SystemExit(main()) на main().

================================================================================
END GRAVITY LAYER 
================================================================================